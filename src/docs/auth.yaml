tags:
  - name: Auth
    description: 사용자 인증, 회원가입, 토큰 관리

components:
  schemas:
    # ----------------------------------------------------------------
    # [Input] 회원가입 요청
    # ----------------------------------------------------------------
    RegisterInput:
      type: object
      required:
        - email
        - emailOptIn
        - password
        - passwordConfirm
        - name
        - phone
        - smsOptIn
        - birthdate
        - gender
      properties:
        email:
          type: string
          format: email
          example: "test@prospecs.com"
          description: "1. 이메일 (ID)"
        emailOptIn:
          type: boolean
          example: true
          description: "2. 이메일 수신동의"
        password:
          type: string
          format: password
          minLength: 6
          example: "password123!"
          description: "3. 비밀번호"
        passwordConfirm:
          type: string
          format: password
          example: "password123!"
          description: "4. 비밀번호 확인 (DB 저장 안 됨, 검증용)"
        name:
          type: string
          example: "홍길동"
          description: "5. 이름"
        phone:
          type: string
          example: "010-1234-5678"
          description: "6. 휴대폰 번호"
        smsOptIn:
          type: boolean
          example: true
          description: "7. SMS 수신동의"
        birthdate:
          type: string
          example: "1990-01-01"
          description: "8. 생년월일 (YYYY-MM-DD 권장)"
        gender:
          type: string
          enum: [ MALE, FEMALE ]
          example: "MALE"
          description: "9. 성별"
        zipCode:
          type: string
          example: "12345"
        address1:
          type: string
          example: "서울시 강남구"
        address2:
          type: string
          example: "101호"

    # ----------------------------------------------------------------
    # [Input] 로그인 요청
    # ----------------------------------------------------------------
    LoginInput:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: "test@test.com"
        password:
          type: string
          format: password
          example: "password123!"

    # ----------------------------------------------------------------
    # [Response] 인증 성공 (토큰 포함)
    # ----------------------------------------------------------------
    AuthResponse:
      type: object
      properties:
        message:
          type: string
          example: "로그인에 성공했습니다."
        token:
          type: string
          description: JWT Access Token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        user:
          $ref: '#/components/schemas/User'

paths:
  /api/auth/register:
    post:
      summary: 회원가입
      tags: [Auth]
      description: 새로운 사용자를 등록합니다. 필수 주소 정보를 포함해야 합니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterInput'
      responses:
        201:
          description: 회원가입 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "User created successfully"
                  user:
                    $ref: '#/components/schemas/User'
        409:
          description: 이미 존재하는 이메일
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: 서버 에러
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/auth/login:
    post:
      summary: 로그인
      tags: [Auth]
      description: 이메일과 비밀번호로 로그인하여 JWT 토큰을 발급받습니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginInput'
      responses:
        200:
          description: 로그인 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        401:
          description: 아이디 또는 비밀번호 불일치
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/auth/me:
    get:
      summary: 내 정보 조회
      tags: [Auth]
      description: |
        현재 로그인한 사용자의 정보를 조회합니다. 
        Header에 `Authorization: Bearer <token>`이 필요합니다.
      security:
        - bearerAuth: [] # 이 엔드포인트는 Bearer Token이 필수
        - apiKeyAuth: [] # 글로벌 설정에 있지만 명시적으로 같이 적어줌
      responses:
        200:
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        401:
          description: 토큰이 없거나 만료됨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        404:
          description: 사용자를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'